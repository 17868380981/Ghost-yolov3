# Ghost-yolov3

# yolov3-tiny:
----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1         [-1, 16, 416, 416]             432
       BatchNorm2d-2         [-1, 16, 416, 416]              32
         LeakyReLU-3         [-1, 16, 416, 416]               0
         MaxPool2d-4         [-1, 16, 208, 208]               0
            Conv2d-5         [-1, 32, 208, 208]           4,608
       BatchNorm2d-6         [-1, 32, 208, 208]              64
         LeakyReLU-7         [-1, 32, 208, 208]               0
         MaxPool2d-8         [-1, 32, 104, 104]               0
            Conv2d-9         [-1, 64, 104, 104]          18,432
      BatchNorm2d-10         [-1, 64, 104, 104]             128
        LeakyReLU-11         [-1, 64, 104, 104]               0
        MaxPool2d-12           [-1, 64, 52, 52]               0
           Conv2d-13          [-1, 128, 52, 52]          73,728
      BatchNorm2d-14          [-1, 128, 52, 52]             256
        LeakyReLU-15          [-1, 128, 52, 52]               0
        MaxPool2d-16          [-1, 128, 26, 26]               0
           Conv2d-17          [-1, 256, 26, 26]         294,912
      BatchNorm2d-18          [-1, 256, 26, 26]             512
        LeakyReLU-19          [-1, 256, 26, 26]               0
        MaxPool2d-20          [-1, 256, 13, 13]               0
           Conv2d-21          [-1, 512, 13, 13]       1,179,648
      BatchNorm2d-22          [-1, 512, 13, 13]           1,024
        LeakyReLU-23          [-1, 512, 13, 13]               0
        ZeroPad2d-24          [-1, 512, 14, 14]               0
        MaxPool2d-25          [-1, 512, 13, 13]               0
           Conv2d-26         [-1, 1024, 13, 13]       4,718,592
      BatchNorm2d-27         [-1, 1024, 13, 13]           2,048
        LeakyReLU-28         [-1, 1024, 13, 13]               0
           Conv2d-29          [-1, 256, 13, 13]         262,144
      BatchNorm2d-30          [-1, 256, 13, 13]             512
        LeakyReLU-31          [-1, 256, 13, 13]               0
           Conv2d-32          [-1, 512, 13, 13]       1,179,648
      BatchNorm2d-33          [-1, 512, 13, 13]           1,024
        LeakyReLU-34          [-1, 512, 13, 13]               0
           Conv2d-35          [-1, 255, 13, 13]         130,815
        YOLOLayer-36        [-1, 3, 13, 13, 85]               0
           Conv2d-37          [-1, 128, 13, 13]          32,768
      BatchNorm2d-38          [-1, 128, 13, 13]             256
        LeakyReLU-39          [-1, 128, 13, 13]               0
         Upsample-40          [-1, 128, 26, 26]               0
           Conv2d-41          [-1, 256, 26, 26]         884,736
      BatchNorm2d-42          [-1, 256, 26, 26]             512
        LeakyReLU-43          [-1, 256, 26, 26]               0
           Conv2d-44          [-1, 255, 26, 26]          65,535
        YOLOLayer-45        [-1, 3, 26, 26, 85]               0
================================================================
Total params: 8,852,366
Trainable params: 8,852,366
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 1.98
Forward/backward pass size (MB): 151.76
Params size (MB): 33.77
Estimated Total Size (MB): 187.51
----------------------------------------------------------------
# Ghost-yolov3-tiny:
----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1         [-1, 16, 416, 416]             432
       BatchNorm2d-2         [-1, 16, 416, 416]              32
         LeakyReLU-3         [-1, 16, 416, 416]               0
         MaxPool2d-4         [-1, 16, 208, 208]               0
            Conv2d-5         [-1, 16, 208, 208]           2,304
       BatchNorm2d-6         [-1, 16, 208, 208]              32
         LeakyReLU-7         [-1, 16, 208, 208]               0
            Conv2d-8         [-1, 16, 208, 208]             144
       BatchNorm2d-9         [-1, 16, 208, 208]              32
        LeakyReLU-10         [-1, 16, 208, 208]               0
        MaxPool2d-11         [-1, 32, 104, 104]               0
           Conv2d-12         [-1, 32, 104, 104]           9,216
      BatchNorm2d-13         [-1, 32, 104, 104]              64
        LeakyReLU-14         [-1, 32, 104, 104]               0
           Conv2d-15         [-1, 32, 104, 104]             288
      BatchNorm2d-16         [-1, 32, 104, 104]              64
        LeakyReLU-17         [-1, 32, 104, 104]               0
        MaxPool2d-18           [-1, 64, 52, 52]               0
           Conv2d-19           [-1, 64, 52, 52]          36,864
      BatchNorm2d-20           [-1, 64, 52, 52]             128
        LeakyReLU-21           [-1, 64, 52, 52]               0
           Conv2d-22           [-1, 64, 52, 52]             576
      BatchNorm2d-23           [-1, 64, 52, 52]             128
        LeakyReLU-24           [-1, 64, 52, 52]               0
        MaxPool2d-25          [-1, 128, 26, 26]               0
           Conv2d-26          [-1, 128, 26, 26]         147,456
      BatchNorm2d-27          [-1, 128, 26, 26]             256
        LeakyReLU-28          [-1, 128, 26, 26]               0
           Conv2d-29          [-1, 128, 26, 26]           1,152
      BatchNorm2d-30          [-1, 128, 26, 26]             256
        LeakyReLU-31          [-1, 128, 26, 26]               0
        MaxPool2d-32          [-1, 256, 13, 13]               0
           Conv2d-33          [-1, 256, 13, 13]         589,824
      BatchNorm2d-34          [-1, 256, 13, 13]             512
        LeakyReLU-35          [-1, 256, 13, 13]               0
           Conv2d-36          [-1, 512, 13, 13]           4,608
      BatchNorm2d-37          [-1, 512, 13, 13]           1,024
        LeakyReLU-38          [-1, 512, 13, 13]               0
        ZeroPad2d-39          [-1, 768, 14, 14]               0
        MaxPool2d-40          [-1, 768, 13, 13]               0
           Conv2d-41         [-1, 1024, 13, 13]       7,077,888
      BatchNorm2d-42         [-1, 1024, 13, 13]           2,048
        LeakyReLU-43         [-1, 1024, 13, 13]               0
           Conv2d-44          [-1, 256, 13, 13]         262,144
      BatchNorm2d-45          [-1, 256, 13, 13]             512
        LeakyReLU-46          [-1, 256, 13, 13]               0
           Conv2d-47          [-1, 512, 13, 13]       1,179,648
      BatchNorm2d-48          [-1, 512, 13, 13]           1,024
        LeakyReLU-49          [-1, 512, 13, 13]               0
           Conv2d-50           [-1, 18, 13, 13]           9,234
        YOLOLayer-51         [-1, 3, 13, 13, 6]               0
           Conv2d-52          [-1, 128, 13, 13]          32,768
      BatchNorm2d-53          [-1, 128, 13, 13]             256
        LeakyReLU-54          [-1, 128, 13, 13]               0
         Upsample-55          [-1, 128, 26, 26]               0
           Conv2d-56           [-1, 18, 26, 26]          41,472
      BatchNorm2d-57           [-1, 18, 26, 26]              36
        YOLOLayer-58         [-1, 3, 26, 26, 6]               0
================================================================
Total params: 9,402,422
Trainable params: 9,402,422
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 1.98
Forward/backward pass size (MB): 146.54
Params size (MB): 35.87
Estimated Total Size (MB): 184.39
----------------------------------------------------------------

# 参考：

https://github.com/ultralytics/yolov3
https://github.com/iamhankai/ghostnet.pytorch
https://github.com/tanluren/yolov3-channel-and-layer-pruning
